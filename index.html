
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <title>Copa Mundial - Llave Completa</title>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: #1a1a1a;
      color: #f1f1f1;
      text-align: center;
      padding: 30px;
    }
    h1, h2, h3 {
      color: #ffd700;
      text-shadow: 2px 2px 4px #000;
    }
    button {
      padding: 5px 10px;
      font-size: 14px;
      margin-left: 5px;
      border: none;
      border-radius: 6px;
      background-color: #ffd700;
      color: #000;
      cursor: pointer;
    }
    .eliminatoria-container {
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }
    .match {
      background: #333;
      padding: 10px;
      border-radius: 10px;
      width: 300px;
      display: flex;
      justify-content: center;
      gap: 10px;
    }
  </style>
</head>
<body>
<h1>üèÜ Copa Mundial ‚Äì Llave Completa</h1>
<p>Ingresa 16 equipos:</p>
<textarea id="jugadoresFaseDirecta" rows="6" cols="40" placeholder="Ingresa 16 equipos, uno por l√≠nea"></textarea><br>
<button onclick="sortearFaseDirecta()">Sortear Cruces</button>

<div id="octavosContainer" class="eliminatoria-container"></div>
<div id="cuartosContainer" class="eliminatoria-container"></div>
<div id="semisContainer" class="eliminatoria-container"></div>
<div id="finalContainer" class="eliminatoria-container"></div>
<div id="campeonContainer" class="eliminatoria-container"></div>

<script>
// JavaScript exacto como el anterior (copiado desde l√≥gica previa)

function sortearFaseDirecta() {
  const textarea = document.getElementById("jugadoresFaseDirecta");
  let jugadores = textarea.value.trim().split("\n").map(j => j.trim()).filter(j => j);
  if (jugadores.length !== 16) {
    alert("Debes ingresar exactamente 16 equipos.");
    return;
  }
  for (let i = jugadores.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [jugadores[i], jugadores[j]] = [jugadores[j], jugadores[i]];
  }
  crearPartidos("Octavos de Final", jugadores, "cuartosContainer", avanzarACuartos);
}

function crearPartidos(tituloTexto, equipos, contenedorId, callback) {
  let container = document.getElementById(contenedorId);
  if (!container) {
    container = document.createElement("div");
    container.id = contenedorId;
    container.className = "eliminatoria-container";
    const titulo = document.createElement("h3");
    titulo.textContent = tituloTexto;
    titulo.style.color = "#ffd700";
    container.appendChild(titulo);
    document.body.appendChild(container);
  } else {
    container.innerHTML = "";
    const titulo = document.createElement("h3");
    titulo.textContent = tituloTexto;
    titulo.style.color = "#ffd700";
    container.appendChild(titulo);
  }

  for (let i = 0; i < equipos.length; i += 2) {
    const div = document.createElement("div");
    div.className = "match";

    const team1 = equipos[i];
    const team2 = equipos[i + 1];

    const span1 = document.createElement("span");
    span1.textContent = team1;

    const input1 = document.createElement("input");
    input1.type = "number";
    input1.min = "0";
    input1.style.width = "40px";

    const span2 = document.createElement("span");
    span2.textContent = team2;

    const input2 = document.createElement("input");
    input2.type = "number";
    input2.min = "0";
    input2.style.width = "40px";

    const goButton = document.createElement("button");
    goButton.textContent = "‚úî";
    goButton.onclick = () => {
      const score1 = parseInt(input1.value);
      const score2 = parseInt(input2.value);
      if (isNaN(score1) || isNaN(score2)) {
        alert("Debes ingresar ambos goles.");
        return;
      }
      let winner = score1 > score2 ? team1 : team2;
      if (score1 === score2) {
        winner = Math.random() > 0.5 ? team1 : team2; // desempate aleatorio
      }
      goButton.disabled = true;
      input1.disabled = true;
      input2.disabled = true;
      goButton.style.background = "#00cc66";
      goButton.textContent = "‚Üí";
      avanzarGanador(container.id + "_next", winner, equipos.length / 2, callback, container);
    };

    div.appendChild(span1);
    div.appendChild(input1);
    div.appendChild(document.createTextNode(" vs "));
    div.appendChild(span2);
    div.appendChild(input2);
    div.appendChild(goButton);
    container.appendChild(div);
  }
}

const avanceState = {};

function avanzarGanador(id, equipo, cantidadEsperada, callback, padre) {
  if (!avanceState[id]) avanceState[id] = [];
  avanceState[id].push(equipo);

  if (avanceState[id].length === cantidadEsperada) {
    const siguiente = avanceState[id];
    avanceState[id] = [];  // limpiar para siguiente ronda
    callback(siguiente, padre);
  }
}

function avanzarACuartos(ganadores, contenedorAnterior) {
  crearPartidos("Cuartos de Final", ganadores, "semisContainer", avanzarASemis);
}

function avanzarASemis(ganadores, contenedorAnterior) {
  crearPartidos("Semifinales", ganadores, "finalContainer", avanzarAFinal);
}

function avanzarAFinal(ganadores, contenedorAnterior) {
  crearPartidos("Final", ganadores, "campeonContainer", mostrarCampeon);
}

function mostrarCampeon(finalistas, contenedorAnterior) {
  const container = document.getElementById("campeonContainer");
  const mensaje = document.createElement("h2");
  mensaje.textContent = "üèÜ Campe√≥n: (elige el ganador con goles)";
  mensaje.style.color = "#00ffcc";
  container.appendChild(mensaje);
}

</script>
</body>
</html>
