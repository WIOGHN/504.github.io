<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>COPA WIOG ‚Äì Mundial Autom√°tico</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f0f4f8; padding: 20px; text-align: center; }
    .grupo { background: #fff; padding: 20px; margin: 20px; border: 1px solid #ccc; display: inline-block; vertical-align: top; width: 320px; }
    .grupo h3 { color: #0077cc; }
    .partido input { width: 40px; text-align: center; }
    .tabla { margin-top: 20px; border-collapse: collapse; width: 100%; }
    .tabla th, .tabla td { border: 1px solid #ccc; padding: 6px; font-size: 14px; }
    .tabla th { background-color: #0077cc; color: #fff; }
    textarea, input, button { margin: 5px; padding: 8px; }
  </style>
</head>
<body>

  <h1>üèÜ COPA WIOG ‚Äì Grupos y Tabla de Posiciones üèÜ</h1>

  <textarea id="listaEquipos" rows="8" cols="40" placeholder="Pega 32 equipos, uno por l√≠nea"></textarea><br />
  <button onclick="sortearGrupos()">üé≤ Sortear Grupos</button>

  <div id="grupos"></div>

  <script>
    let equipos = [];
    const letras = "ABCDEFGH".split("");

    function sortearGrupos() {
      equipos = document.getElementById('listaEquipos').value.trim().split('\n').map(e => e.trim()).filter(e => e);
      if (equipos.length !== 32) return alert("Debes ingresar exactamente 32 equipos.");
      equipos = equipos.sort(() => Math.random() - 0.5);
      const grupos = {};
      letras.forEach((l, i) => grupos[l] = equipos.slice(i*4, (i+1)*4));
      mostrarGrupos(grupos);
    }

    function mostrarGrupos(grupos) {
      const container = document.getElementById('grupos');
      container.innerHTML = '';
      for (let letra of letras) {
        const eq = grupos[letra];
        const partidos = [[0,1],[2,3],[0,2],[1,3],[0,3],[1,2]];
        let html = `<div class='grupo'><h3>Grupo ${letra}</h3><ul>${eq.map(e => `<li>${e}</li>`).join('')}</ul><hr>`;
        partidos.forEach((p, i) => {
          html += `
            <div>
              ${eq[p[0]]}
              <input id="${letra}${i}a" type="number" min="0" />
              -
              <input id="${letra}${i}b" type="number" min="0" />
              ${eq[p[1]]}
            </div>
          `;
        });
        html += `<button onclick="calcularTabla('${letra}', ${JSON.stringify(eq).replace(/"/g, '&quot;')})">Ver Tabla</button><div id="tabla_${letra}"></div></div>`;
        container.innerHTML += html;
      }
    }

    function calcularTabla(grupo, eq) {
      const stats = {};
      eq.forEach(e => stats[e] = {PJ:0,PG:0,PE:0,PP:0,GF:0,GC:0,DG:0,Puntos:0});
      const orden = [[0,1],[2,3],[0,2],[1,3],[0,3],[1,2]];
      orden.forEach((p,i) => {
        const g1 = parseInt(document.getElementById(`${grupo}${i}a`).value);
        const g2 = parseInt(document.getElementById(`${grupo}${i}b`).value);
        if (isNaN(g1) || isNaN(g2)) return;
        const A = eq[p[0]], B = eq[p[1]];
        stats[A].PJ++; stats[B].PJ++;
        stats[A].GF += g1; stats[A].GC += g2;
        stats[B].GF += g2; stats[B].GC += g1;
        if (g1 > g2) { stats[A].PG++; stats[B].PP++; stats[A].Puntos += 3; }
        else if (g1 < g2) { stats[B].PG++; stats[A].PP++; stats[B].Puntos += 3; }
        else { stats[A].PE++; stats[B].PE++; stats[A].Puntos +=1; stats[B].Puntos +=1; }
      });
      eq.forEach(e => stats[e].DG = stats[e].GF - stats[e].GC);
      const tabla = eq.map(e => ({Equipo: e, ...stats[e]}))
        .sort((a,b) => b.Puntos - a.Puntos || b.DG - a.DG || b.GF - a.GF);
      let html = `<table class='tabla'><tr><th>Equipo</th><th>PJ</th><th>PG</th><th>PE</th><th>PP</th><th>GF</th><th>GC</th><th>DG</th><th>Pts</th></tr>`;
      tabla.forEach(t => {
        html += `<tr><td>${t.Equipo}</td><td>${t.PJ}</td><td>${t.PG}</td><td>${t.PE}</td><td>${t.PP}</td><td>${t.GF}</td><td>${t.GC}</td><td>${t.DG}</td><td>${t.Puntos}</td></tr>`;
      });
      html += "</table>";
      document.getElementById(`tabla_${grupo}`).innerHTML = html;
    }
  </script>

</body>
</html>
